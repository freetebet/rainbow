<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.rainbow.company.salesManagement.mapper.salesMgtMapper">
	
	<select id="monthChartData" resultType="org.rainbow.company.salesManagement.domain.monthChartVO">
		SELECT
		DATE_FORMAT(recDate, '%Y-%m') AS recSum_month,
		TRUNCATE(SUM(recSum),0) AS total_amount
		FROM
		    RAIN_receipt_tbl
		GROUP BY
		    DATE_FORMAT(recDate, '%Y-%m')
		ORDER BY
		recSum_month
	</select>
	
	<select id="quarterChartData" resultType="org.rainbow.company.salesManagement.domain.monthChartVO">
		SELECT
	    CONCAT(YEAR(recDate), '년',
	           QUARTER(recDate),'분기') AS recSum_quarter,
	    TRUNCATE(SUM(recSum),0) AS quarter_amount
		FROM
		    RAIN_receipt_tbl
		GROUP BY
		     CONCAT(YEAR(recDate), '년',QUARTER(recDate),'분기')
		ORDER BY
		    recSum_quarter
	</select>
	
	
	<select id="salesComList" resultType="org.rainbow.company.salesManagement.domain.salesComVO">
		select b.companyNo, e.comName, sum(a.recSum) recSumTotal , sum(a.recSup) recSupTotal, sum(a.recTax) recTaxTotal, sum(d.prdCstPri) prdCstPriTotal, 
		sum(d.prdCstSup) prdCstSupTotal, sum(d.prdCstTax) prdCstTaxTotal, 
		sum(a.recAdd - a.recDed) resADTotal, sum(a.recAddSup - a.recDedSup) resADSupTotal,
		sum(a.recAddTax - a.recAddCstTax) resADTaxTotal
		FROM RAIN_receipt_tbl a
		JOIN RAIN_cSpot_tbl b ON a.spotNo = b.spotNo
		JOIN RAIN_order_tbl c ON a.ordNo = c.ordNo
		LEFT JOIN RAIN_Products_tbl d ON c.prdNo = d.prdNo
		JOIN RAIN_cCompany_tbl e ON b.companyNo = e.companyNo
		GROUP BY b.companyNo
	</select>
	


	
</mapper>
